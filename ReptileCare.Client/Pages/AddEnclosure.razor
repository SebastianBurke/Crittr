@page "/add-enclosure"
@using ReptileCare.Shared.DTOs
@inject HttpClient Http
@inject NavigationManager Navigation

<h3>Add Enclosure</h3>

<EditForm Model="newEnclosure" OnValidSubmit="HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <InputText @bind-Value="newEnclosure.Name" placeholder="Name" class="form-control" />
    <InputNumber @bind-Value="newEnclosure.Length" placeholder="Length" class="form-control" />
    <InputNumber @bind-Value="newEnclosure.Width" placeholder="Width" class="form-control" />
    <InputNumber @bind-Value="newEnclosure.Height" placeholder="Height" class="form-control" />
    <InputText @bind-Value="newEnclosure.SubstrateType" placeholder="Substrate Type" class="form-control" />
    <InputCheckbox @bind-Value="newEnclosure.HasUVBLighting" /> Has UVB Lighting<br />
    <InputCheckbox @bind-Value="newEnclosure.HasHeatingElement" /> Has Heating Element<br />
    <InputNumber @bind-Value="newEnclosure.IdealTemperature" placeholder="Ideal Temp" class="form-control" />
    <InputNumber @bind-Value="newEnclosure.IdealHumidity" placeholder="Ideal Humidity" class="form-control" />

    <button type="submit" class="btn btn-primary">Add Enclosure</button>
</EditForm>

@code {
    private EnclosureProfileDto newEnclosure = new();

    private async Task HandleValidSubmit()
    {
        var response = await Http.PostAsJsonAsync("api/enclosures", newEnclosure);
        if (response.IsSuccessStatusCode)
        {
            Navigation.NavigateTo("/enclosures");
        }
        else
        {
            // handle errors
        }
    }
}